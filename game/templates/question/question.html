{% extends "base.html" %}

{% block contenido %}

{# Just a simple question #}
<div class="container">
    <div class="row centered">
        <div class="col-lg-12">
            {% if question.image %}
                <img src="{{ question.image.url }}" class="img-thumbnail" height="900" width="800">
            {% endif %}
            </div>
        <div class="col-lg-12">
            <h2><strong>{{ question.text }}</strong></h2>
        </div>
    </div>

<form id="form" action="{% url 'game:save-response' %}" onsubmit="return ValidateAttempts()" method="post">
{% csrf_token %}
    {% if question.type == "TEXTO" %}
        <div class="row centered">
            <div class="row form-group"></div>
            <div class="row form-group"></div>
            <div class="row form-group">
                <input type="text" name="answer">
            </div>
        </div>
    {% elif question.type == "CUESTIONARIO" %}
        {% for answer in answers %}
            <div class="row">
                <div class="col-lg-6 col-lg-offset-2">
                    <h2><input type="radio" name="answer" value="{{ answer.id }}">
                    {{ answer.text }}</h2>
                </div>
            </div>
        {% endfor %}
    {% endif %}
    <input type="hidden" name="question_id" value="{{ question.id }}">
    <div class="row form-group"></div>
    <div class="row form-group"></div>
    <div class="row centered">
        <div class="col-lg-12">
            <input type="submit" class="btn btn-success btn-lg" value="Siguiente"/>
        </div>
    </div>
</form>

<script>

        function ValidateAttempts() {
            // Comprobamos validez de la respuesta
            return true;
        }
        /*
        document.getElementById("form").addEventListener("submit", function () {
            alert("try");
           return false;
        });*/
</script>



{% if cheat_number > 0 %}
    <button id="cheat">¡Dame pistas!</button>

    <script>
        


        var cheat_count = 0;
        var cheat_number = "{{ cheat_number }}"; // Número de pistas máximo
        var question_id = "{{ question.id }}";

        document.getElementById("cheat").addEventListener("click", function () {
            if (confirm("¡Usar pistas te restará puntos! ¿Quieres continuar?") == false) {
                return;
            }
            if(cheat_count >= cheat_number){
                alert("No hay más pistas :D");
                return;
            }
            var request = new XMLHttpRequest();
            request.open('GET', '/question-cheat/' + question_id + '/' + cheat_count, true);

            request.onload = function() {

                if (request.status >= 200 && request.status < 400) {
                    // Success!
                    var resp = request.responseText;
                    alert("Pista número " + cheat_count + ": " + resp);
                    console.log(cheat_count + ", " + question_id);
                    cheat_count ++;
                } else {
                    console.log("Error con el servidor");
                }
            };

            request.onerror = function() {
            // There was a connection error of some sort
            };

            request.send();


        });



    </script>
{% endif %}
</div>


{% endblock %}